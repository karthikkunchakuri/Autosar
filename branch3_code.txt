Branch3 code modifications